<!doctype html>
<html lang="en"  xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Location Dashboard</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3udL3KCDrHNVCo59XmW6p1ffm6RjVXPk"></script>
    <style>
        body {
            background-color: black;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1, h2 {
            text-align: center;
            margin-bottom: 20px;
        }
        form {
            margin-bottom: 20px;
            padding: 20px;
            border: 1px solid white;
            border-radius: 5px;
            background-color: #1c1c1c;
        }
        input, button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid white;
            border-radius: 5px;
            background-color: #333;
            color: white;
        }
        button {
            background-color: #555;
            cursor: pointer;
        }
        button:hover {
            background-color: #777;
        }
        .response {
            padding: 10px;
            margin-top: 10px;
            border: 1px solid white;
            border-radius: 5px;
            background-color: #2e2e2e;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Location Dashboard</h1>

    <div id="map" style="height: 450px; width: 100%;">

    </div>

    <h2>Create Location</h2>
    <form method="post" th:action="@{/api/v1/markers/new}" enctype="application/x-www-form-urlencoded">
        <h2>Create Location</h2>

        <label for="createTitle" class="label">Title:</label>
        <input type="text" id="createTitle" name="title" placeholder="Title" required>

        <label for="createDescription" class="label">Description:</label>
        <input type="text" id="createDescription" name="description" placeholder="Description" required>

        <label class="label" for="createType">Marker Type:</label>
        <select id="createType" name="markerType" required>
            <option value="CUSTOM">Custom</option>
            <option value="BUILDING">Building</option>
            <option value="ROAD">Road</option>
            <option value="RESTAURANT">Restaurant</option>
            <option value="STORE">Store</option>
            <option value="PARK">Park</option>
            <option value="RIVER">River</option>
            <option value="LAKE">Lake</option>
        </select><br><br>

        <label for="createLatitude" class="label">Latitude:</label>
        <input type="number" id="createLatitude" name="latitude" placeholder="Latitude" step="any" required>

        <label for="createLongitude" class="label">Longitude:</label>
        <input type="number" id="createLongitude" name="longitude" placeholder="Longitude" step="any" required>

        <input formtarget="_blank" class="submit" type="submit" value="Create Location">
    </form>



    <form method="get" th:action="@{/api/v1/markers}" enctype="application/x-www-form-urlencoded">
        <h2>Get Location</h2>
        <label for="getId" class="label">Location ID:</label>
        <input type="text" id="getId" name="id" placeholder="Location ID" required>
        <input formtarget="_blank" class="submit" type="submit" value="Get Location">
    </form>


    <form method="get" th:action="@{/api/v1/markers/all}">
        <h2>Get All Locations</h2>
        <input formtarget="_blank" class="submit" type="submit" value="Get All Locations">
    </form>




    <form id="updateForm">
        <label for="markerUpId">Marker ID:</label>
        <input type="number" id="markerUpId" name="markerUpId" required><br><br>

        <label for="title">Title:</label>
        <input type="text" id="title" name="title" required><br><br>

        <label for="description">Description:</label>
        <textarea id="description" name="description" required rows="5" cols="40"></textarea><br><br>

        <label for="markerType">Marker Type:</label>
        <select id="markerType" name="markerType" required>
            <option value="CUSTOM">Custom</option>
            <option value="BUILDING">Building</option>
            <option value="ROAD">Road</option>
            <option value="RESTAURANT">Restaurant</option>
            <option value="STORE">Store</option>
            <option value="PARK">Park</option>
            <option value="RIVER">River</option>
            <option value="LAKE">Lake</option>
        </select><br><br>

        <label for="latitude">Latitude:</label>
        <input type="number" id="latitude" name="latitude" step="any" required><br><br>

        <label for="longitude">Longitude:</label>
        <input type="number" id="longitude" name="longitude" step="any" required><br><br>

        <button type="submit">Update Marker</button>
    </form>


    <form id="deleteForm">
        <label for="markerId">Enter Marker ID to Delete:</label>
        <input type="number" id="markerId" name="markerId" required>
        <button type="submit">Delete Marker</button>
    </form>

</div>

<script>
    function initMap() {
        const mapOptions = {
            center: {lat: 39.15991494905332, lng: 46.26663066688381},
            zoom: 10,
            // zoom: 15,
            mapTypeId: 'hybrid',
            tilt: 45,
            gestureHandling: "cooperative",
            heading: 90,
            // zoomControl: false,
            mapTypeControl: true,
            streetViewControl: false,
            // fullscreenControl: false
        };

        const map = new google.maps.Map(document.getElementById('map'), mapOptions);

        map.addListener('rightclick', function (event) {
            const lat = event.latLng.lat();
            const lng = event.latLng.lng();
            alert('Latitude: ' + lat + ', Longitude: ' + lng);
        });
    }

    window.onload = initMap;


        document.getElementById('deleteForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const markerId = document.getElementById('markerId').value;
        const url = `/api/v1/markers/delete/${markerId}`;

        fetch(url, {
        method: 'DELETE',
        headers: {
        'Content-Type': 'application/json'
    }
    })
        .then(response => response.json())
        .then(data => {
        alert(`Status: ${data.status}\nMessage: ${data.message}`);
    })
        .catch((error) => {
        console.error('Error:', error);
    });
    });

    document.getElementById('updateForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const markerId = document.getElementById('markerUpId').value;
        const title = document.getElementById('title').value;
        const description = document.getElementById('description').value;
        const markerType = document.getElementById('markerType').value;
        const latitude = document.getElementById('latitude').value;
        const longitude = document.getElementById('longitude').value;

        const url = `/api/v1/markers/update/${markerId}`;
        const data = new URLSearchParams();
        data.append('title', title);
        data.append('description', description);
        data.append('markerType', markerType);
        data.append('latitude', latitude);
        data.append('longitude', longitude);

        fetch(url, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: data
        })
            .then(response => response.json())
            .then(data => {

                alert(`Status: ${data.status}\nMessage: ${data.message}`);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });
</script>
</body>
</html>