<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Location Dashboard</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3udL3KCDrHNVCo59XmW6p1ffm6RjVXPk"></script>
    <style>
        /* General Styles */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: #007bff;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .tab-button {
            padding: 10px 20px;
            margin: 0 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .tab-button.active {
            background-color: #0056b3;
        }

        .content {
            display: none;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .content.active {
            display: block;
        }

        /* Map Section */
        #map {
            height: 500px;
            width: 100%;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        /* Groups and Sections */
        .group {
            margin-bottom: 30px;
            border: 4px solid #000115;
        }

        .group h2 {
            margin-bottom: 15px;
            color: #007bff;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }

        .title-form-dash {
            color: #030771 !important;
            border-bottom: none !important;
            text-align: center;
            font-size: 30px;
            margin: 5px 0;
            padding: 10px 0;
        }

        .link-to-dash {
            font-size: 20px;
            color: black;
            font-weight: bolder;
            text-decoration: none;
            border: 2px solid #021b40;
        }

        form {
            border: 4px solid #0063E2;
            padding: 10px;
            margin: 5px 0;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }

        .form-group textarea {
            resize: vertical;
        }

        .submit {
            padding: 10px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .submit:hover {
            background-color: #218838;
        }

        .delete-button {
            padding: 10px 20px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .delete-button:hover {
            background-color: #c82333;
        }

        /* Collapsible Sections */
        details {
            margin-bottom: 20px;
        }

        details summary {
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }

        details ul {
            list-style-type: none;
            padding: 0;
        }

        details ul li {
            margin: 10px 0;
        }

        details ul li a {
            text-decoration: none;
            color: #007bff;
        }

        details ul li a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Admin Panel</h1>
    <div class="tabs">
        <button class="tab-button active" onclick="showContent('mapSection')">Map</button>
        <button class="tab-button" onclick="showContent('contactsSection')">Contacts</button>
    </div>
</div>

<div id="mapSection" class="container content active">
    <div id="map" style="height: 700px; width: 100%;">

    </div>
    <!--        <details>-->
    <!--            <summary>Markerl…ôr √º√ß√ºn metodlar</summary>-->
    <!--            <ul>-->
    <!--                <li><a href="#yaratmaqD">1 ~ Yenisini yaratmaq</a></li>-->
    <!--                <li><a href="#hamisiniT">2 ~ B√ºt√ºn lokasiyalarƒ±n siyahƒ±sƒ±</a></li>-->
    <!--                <li><a href="#adiIleT">3 ~ Lokasiya adƒ± il…ô axtarƒ±≈ü</a></li>-->
    <!--                <li><a href="#idTapmaq">4 ~ id il…ô axtarƒ±≈ü</a></li>-->
    <!--                <li><a href="#updateMarkerTypeForm">5 ~ Lokasiyanƒ±n n√∂v√ºn√º d…ôyi≈üm…ôk</a></li>-->
    <!--                <li><a href="#updateDescriptionForm">6 ~ Lokasiya haqqƒ±nda m…ôlumatƒ± d…ôyi≈üm…ôk</a></li>-->
    <!--                <li><a href="#updateForm">7 ~ Lokasiyanƒ± tam d…ôyi≈üm…ôk</a></li>-->
    <!--                <li><a href="#deleteForm">8 ~ Lokasiyanƒ± ƒ∞D il…ô silm…ôk</a></li>-->
    <!--            </ul>-->
    <!--        </details>-->
    <h1 style="text-align: center;">Markerl…ôr √º√ß√ºn methodlar</h1>
    <div class="group">
        <h2 class="title-form-dash">Markerin yenisini yaratmaq</h2>
        <form id="yaratmaqD" method="post" th:action="@{/api/v1/markers/new}"
              enctype="application/x-www-form-urlencoded">
            <h2>Yenisini Yaratmaq</h2>

            <label for="createTitle" class="label">Yerin adƒ±:</label>
            <input type="text" id="createTitle" name="title" placeholder="Title" required>

            <label for="createDescription" class="label">haqqƒ±nda:</label>
            <input type="text" id="createDescription" name="description" placeholder="Description" required>

            <label class="label" for="createType">N√∂v√º(≈ü…ôh…ôr, rayon, k…ônd v…ô s):</label>
            <select id="createType" name="markerType" required>
                <option value="CUSTOM">normal</option>
                <option value="BUILDING">K…ônd</option>
                <option value="ROAD">yol</option>
                <option value="RESTAURANT">Restaurant</option>
                <option value="STORE">maƒüaza</option>
                <option value="PARK">Park</option>
                <option value="RIVER">√ßay</option>
                <!--                <option value="LAKE">Lake</option>-->
                <option value="VILLAGE">Xaraba</option>
                <option value="CITY">≈û…ôh…ôr</option>
                <option value="REGION">Rayon</option>
            </select><br><br>

            <label for="createLatitude" class="label">Latitude:</label>
            <input type="number" id="createLatitude" name="latitude" placeholder="Latitude" step="any" required>

            <label for="createLongitude" class="label">Longitude:</label>
            <input type="number" id="createLongitude" name="longitude" placeholder="Longitude" step="any" required>

            <input formtarget="_blank" class="submit" type="submit" value="yeni lokasiya yarat">
        </form>
        <br><br>
        <h2 class="title-form-dash">GeoJSON Fayl Y√ºkl…ôm…ô</h2>
        <a class="link-to-dash" target="_blank" href="https://products.aspose.app/gis/conversion/kml-to-geojson">Kml
            faylƒ±nƒ± geoJsona d…ôyi≈üm…ôk √º√ß√ºn ke√ßid el…ô <--</a>
        <form id="uploadGeoJsonForm" enctype="multipart/form-data">
            <input type="file" id="geoJsonFile" name="file" accept=".geojson" required>
            <button type="submit">Faylƒ± Y√ºkl…ô</button>
        </form>
    </div>

    <div class="group">
        <h2 class="title-form-dash">Markerl…ôrin axtarƒ±≈üƒ±</h2>

        <form id="idTapmaq" method="get" th:action="@{/api/v1/markers}" enctype="application/x-www-form-urlencoded">
            <h2>ƒ∞d-y…ô g√∂r…ô tapmaq</h2>
            <label for="getId" class="label">Location ID:</label>
            <input type="text" id="getId" name="id" placeholder="Location ID" required>
            <input formtarget="_blank" class="submit" type="submit" value="Lokasiyanƒ± …ôld…ô et">
        </form>

        <form id="hamisiniT" method="get" th:action="@{/api/v1/markers/all}">
            <h2>B√ºt√ºn lokasiyalarƒ± tapmaq</h2>
            <input formtarget="_blank" class="submit" type="submit" value="B√ºt√ºn lokasiyalarƒ±n siyahƒ±sƒ±">
        </form>
        <form id="duplicates-section" method="get" th:action="@{/api/v1/markers/duplicates}">
            <h2>Ox≈üar pinl…ôri √ºz…ô √ßƒ±xartmaq, …ôg…ôr varsa</h2>
            <input formtarget="_blank" class="submit" type="submit" value="B√ºt√ºn ox≈üar lokasiyalarƒ±n siyahƒ±sƒ±">
        </form>
        <form id="deleteAllContactsDuplicates">
            <h2>b√ºt√ºn duplicatlarƒ± silm…ôk</h2>
            <button type="submit">Hamƒ±sƒ±nƒ± silm…ôk</button>
        </form>
        <form id="adiIleT" method="get" action="/api/v1/markers/by-title" enctype="application/x-www-form-urlencoded">
            <h2>Adƒ±na g√∂r…ô tapmaq</h2>

            <label for="getTitle" class="label">Adƒ±:</label>
            <input type="text" id="getTitle" name="title" placeholder="adƒ±nƒ± yaz" required>

            <input formtarget="_blank" class="submit" type="submit" value="m…ôlumatƒ± …ôld…ô et">
        </form>
    </div>


    <div class="group">
        <h2 class="title-form-dash">Markerin d…ôyi≈üdirilm…ôsi</h2>

        <form id="updateMarkerTypeForm" enctype="application/x-www-form-urlencoded">
            <h2>Markerin n√∂v√ºn√º d…ôyi≈üm…ôk</h2>

            <label for="markerId">Marker ID:</label>
            <input type="number" id="typeMarkerId" name="markerId" required><br><br>

            <label for="markerType">Marker Type:</label>
            <select id="newMarkerType" name="markerType" required>
                <option value="CUSTOM">Normal</option>
                <option value="BUILDING">K…ônd</option>
                <option value="ROAD">Yol</option>
                <option value="RESTAURANT">Restaurant</option>
                <option value="STORE">Maƒüaza</option>
                <option value="PARK">Park</option>
                <option value="RIVER">√áay</option>
                <option value="VILLAGE">Xaraba</option>
                <option value="REGION">Rayon</option>
                <option value="CITY">≈û…ôh…ôr</option>
            </select><br><br>

            <button type="submit">Markerin n√∂v√ºn√º yenil…ô</button>
        </form>

        <form id="updateNameForm" enctype="application/x-www-form-urlencoded">
            <h2>Markerin adƒ±nƒ± d…ôyi≈üm…ôk</h2>

            <label for="markerIdGetN">Marker ID:</label>
            <input type="number" id="markerIdGetN" name="markerN" required><br><br>
            <label for="newName">Yeni adƒ± : </label>
            <input type="text" id="newName" name="name" required><br><br>
            <button type="submit">Yenil…ô</button>
        </form>


        <form id="updateDescriptionForm" enctype="application/x-www-form-urlencoded">
            <h2>Markerin ~haqqƒ±nda(description)~ hiss…ôsini yenil…ôm…ôk</h2>

            <label for="markerIdGet">Marker ID:</label>
            <input type="number" id="markerIdGet" name="markerId" required><br><br>

            <label for="newDescription">Haqqƒ±nda:</label>
            <textarea id="newDescription" name="description" required rows="5" cols="40"
                      placeholder="Enter new description"></textarea><br><br>

            <button type="submit">Yenil…ô</button>
        </form>


        <form id="updateForm" enctype="application/x-www-form-urlencoded">
            <h2>Tam d…ôyi≈üm…ôk</h2>

            <label for="markerUpId">Marker ID:</label>
            <input type="number" id="markerUpId" name="markerUpId" required><br><br>

            <label for="title">Adƒ±:</label>
            <input type="text" id="title" name="title" required><br><br>

            <label for="description">Haqqƒ±nda:</label>
            <textarea id="description" name="description" required rows="5" cols="40"></textarea><br><br>

            <label for="markerType">Marker n√∂v√º:</label>
            <select id="markerType" name="markerType" required>
                <option value="CUSTOM">Normal</option>
                <option value="BUILDING">K…ônd</option>
                <option value="ROAD">Yol</option>
                <option value="RESTAURANT">Restaurant</option>
                <option value="STORE">Maƒüaza</option>
                <option value="PARK">Park</option>
                <option value="RIVER">√ßay</option>
                <!--                <option value="LAKE">Lake</option>-->
                <option value="VILLAGE">Xaraba</option>
                <option value="CITY">≈û…ôh…ôr</option>
                <option value="REGION">Rayon</option>
            </select><br><br>

            <label for="latitude">Latitude:</label>
            <input type="number" id="latitude" name="latitude" step="any" required><br><br>

            <label for="longitude">Longitude:</label>
            <input type="number" id="longitude" name="longitude" step="any" required><br><br>

            <button type="submit">lokasiyanƒ± yenil…ô</button>
        </form>
    </div>
    <div class="group">
        <h2 class="title-form-dash">M√∂vcud markerin descriptionuna t…ôrc√ºm…ô …ôlav…ô et</h2>

        <form id="addTranslationForm">
            <label for="markerIdTranslate" class="label">Marker ID:</label>
            <input type="number" id="markerIdTranslate" name="markerId" placeholder="Markerin ID-si" required>

            <label for="languageCode" class="label">Dil kodu (m…ôs: en, ru):</label>
            <input type="text" id="languageCode" name="languageCode" placeholder="en" required maxlength="2" pattern="[a-z]{2}">

            <label for="translatedDescription" class="label">T…ôrc√ºm…ô edilmi≈ü t…ôsvir:</label>
            <input type="text" id="translatedDescription" name="description" placeholder="T…ôsvir" required>

            <button type="submit">T…ôrc√ºm…ô …ôlav…ô et</button>
        </form>

    </div>
    <div class="group">
        <h2 class="title-form-dash">B√ºt√ºn t…ôrc√ºm…ôl…ôri …ôld…ô et</h2>
        <form id="getAllTranslationsForm">
            <button type="submit">T…ôrc√ºm…ôl…ôri g…ôtir</button>
        </form>
        <div id="translationResults"></div>
    </div>
    <div class="group">
        <h2 class="title-form-dash">T…ôrc√ºm…ôni sil</h2>
        <form id="deleteTranslationForm">
            <label for="translateId" class="label">T…ôrc√ºm…ônin ID-si:</label>
            <input type="number" id="translateId" name="id" placeholder="ID" required>
            <button type="submit">Sil</button>
        </form>
    </div>

    <div class="group">
        <h2 class="title-form-dash">Markerin silinm…ôsi</h2>

        <form id="deleteForm">
            <h2>Silm…ôk</h2>

            <label for="markerId">Lokasiyanƒ±n ƒ∞d -ni …ôlav…ô et:</label>
            <input type="number" id="markerId" name="markerId" required>
            <button type="submit">M…ôlumatƒ± silm…ôk</button>
        </form>
    </div>

    <div class="group">
        <h2 class="title-form-dash">Yeni "T…ô≈ü…ôkk√ºrl…ôr" B√∂lm…ôsi ∆èlav…ô Et</h2>
        <form id="addDetailForm">
            <label for="detailName">B√∂lm…ô Adƒ±:</label>
            <input type="text" id="detailName" placeholder="M…ôs…ôl…ôn: Layih…ô D…ôst…ôkl…ôyicil…ôri" required>
            <button type="submit">Yeni B√∂lm…ô Yarat</button>
        </form>



        <h2 class="title-form-dash">M√∂vcud B√∂lm…ôy…ô Yeni Ad ∆èlav…ô Et</h2>
        <form id="addContributorForm">
            <label for="detailSelect">B√∂lm…ô Se√ßin:</label>
            <select id="detailSelect" required>
                <option value="">∆èvv…ôlc…ô bir b√∂lm…ô se√ßin</option>
            </select>


            <label for="contributorName">ƒ∞≈ütirak√ßƒ±nƒ±n Adƒ±:</label>
            <input type="text" id="contributorName" placeholder="M…ôs…ôl…ôn: Toghrul Baƒüƒ±rlƒ±" required>

            <button type="submit">Yeni Ad ∆èlav…ô Et</button>
        </form>



        <h2 class="title-form-dash">B√∂lm…ôni Sil</h2>
        <form id="deleteSectionForm">
            <label for="deleteSectionSelect">Silin…ôc…ôk B√∂lm…ô:</label>
            <select id="deleteSectionSelect" required>
                <option value="">B√∂lm…ô Se√ßin</option>
            </select>
            <button type="submit" class="delete-button">B√∂lm…ôni Sil</button>
        </form>



        <h2 class="title-form-dash">ƒ∞≈ütirak√ßƒ±nƒ± Sil</h2>
        <form id="deleteContributorForm">
            <label for="deleteContributorSelect">Silin…ôc…ôk B√∂lm…ô:</label>
            <select id="deleteContributorSelect" required>
                <option value="">B√∂lm…ô Se√ßin</option>
            </select>

            <label for="deleteContributorName">Silin…ôc…ôk Ad:</label>
            <input type="text" id="deleteContributorName" placeholder="ƒ∞≈ütirak√ßƒ±nƒ±n Adƒ±" required>

            <button type="submit" class="delete-button">ƒ∞≈ütirak√ßƒ±nƒ± Sil</button>
        </form>
    </div>
    <div class="group">
        <h2 class="title-form-dash">B√ºt√ºn ƒ∞≈ütirak√ßƒ±larƒ± G√∂r v…ô Sil</h2>

        <div id="contributorsList" style="padding: 10px; background: #f9f9f9; border: 1px solid #ddd; border-radius: 5px;">
            <p>ƒ∞≈ütirak√ßƒ±lar y√ºkl…ônir...</p>
        </div>

        <form id="deleteContributorByIdForm" style="margin-top: 20px;">
            <label for="deleteContributorById">Silin…ôc…ôk ƒ∞≈ütirak√ßƒ±nƒ±n ƒ∞D-si:</label>
            <input type="number" id="deleteContributorById" placeholder="ƒ∞≈ütirak√ßƒ± ID" required>
            <button type="submit" class="delete-button">ƒ∞≈ütirak√ßƒ±nƒ± Sil (ƒ∞D il…ô)</button>
        </form>
    </div>



</div>

<div id="contactsSection" class="content">
    <form method="get" th:action="@{/api/v1/markers/contact/all}">
        <h2>M…ôktub qutusuna baxmaq</h2>
        <input formtarget="_blank" class="submit" type="submit" value="m…ôktub qutusunu a√ßmaq">
    </form>
    <form id="deleteSingleForm">
        <h2>id il…ô g…ôl…ôn mesajlarƒ± silm…ôk </h2>
        <input type="hidden" name="_csrf" value="${_csrf.token}">

        <label for="contactId">silm…ôk ist…ôdiyiniz mesajƒ±n ƒ∞D-si: </label>
        <input type="number" id="contactId" name="contactId" required>
        <input type="submit" value="delete a contact"/>
    </form>

    <form id="deleteAllContactsForm">
        <h2>b√ºt√ºn mesajlarƒ± silm…ôk</h2>
        <button type="submit">Hamƒ±sƒ±nƒ± silm…ôk</button>
    </form>


</div>

</div>

<script>
    function initMap() {
        const mapOptions = {
            center: {lat: 39.15991494905332, lng: 46.26663066688381},
            zoom: 10,
            // zoom: 15,
            mapTypeId: 'hybrid',
            tilt: 45,
            gestureHandling: "cooperative",
            heading: 90,
            // zoomControl: false,
            mapTypeControl: true,
            streetViewControl: false,
            // fullscreenControl: false
        };

        const map = new google.maps.Map(document.getElementById('map'), mapOptions);

        map.addListener('rightclick', function (event) {
            const lat = event.latLng.lat();
            const lng = event.latLng.lng();
            alert('Latitude: ' + lat + ', Longitude: ' + lng);
        });


        let longPressTimeout;

        map.addListener('touchstart', function (event) {
            longPressTimeout = setTimeout(() => {
                const lat = event.latLng.lat();
                const lng = event.latLng.lng();
                alert('Latitude: ' + lat + ', Longitude: ' + lng);
            }, 800);
        });

        map.addListener('touchend', function () {
            clearTimeout(longPressTimeout);
        });

        map.addListener('touchmove', function () {
            clearTimeout(longPressTimeout);
        });
    }

    window.onload = initMap;


    document.getElementById('deleteForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const markerId = document.getElementById('markerId').value;
        const url = `/api/v1/markers/delete/${markerId}`;

        fetch(url, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.json())
            .then(data => {
                alert(`Status: ${data.status}\nMessage: ${data.message}`);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });

    document.getElementById('addTranslationForm').addEventListener('submit', function (event) {
        const langInput = document.getElementById('languageCode');
        const langValue = langInput.value.trim();

        if (!/^[a-z]{2}$/.test(langValue)) {
            event.preventDefault();
            alert('Dil kodu yalnƒ±z 2 h…ôrfd…ôn ibar…ôt ola bil…ôr (m…ôs…ôl…ôn, "en", "ru")');
            langInput.focus();
            return false;
        }
        event.preventDefault();

        const markerId = document.getElementById('markerIdTranslate').value;
        const languageCode = document.getElementById('languageCode').value;
        const description = document.getElementById('translatedDescription').value;

        const url = `/api/v1/markers/translate/add?markerId=${markerId}`;
        const data = {
            languageCode: languageCode,
            description: description
        };

        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => {
                if (!response.ok) {
                    return response.text().then(text => { throw new Error(text); });
                }
                return response.json();
            })
            .then(data => {
                alert(`Uƒüurla …ôlav…ô olundu!\nDil: ${data.languageCode}\nT…ôsvir: ${data.description}`);
            })
            .catch((error) => {
                alert("X…ôta ba≈ü verdi: " + error.message);
                console.error('Error:', error);
            });
    });
    document.getElementById('getAllTranslationsForm').addEventListener('submit', function (event) {
        event.preventDefault();

        fetch('/api/v1/markers/translate/all')
            .then(response => response.json())
            .then(data => {
                const resultDiv = document.getElementById('translationResults');
                resultDiv.innerHTML = ''; // –æ—á–∏—Å—Ç–∫–∞ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º

                if (data.length === 0) {
                    resultDiv.innerHTML = '<p>T…ôrc√ºm…ô tapƒ±lmadƒ±.</p>';
                    return;
                }

                data.forEach(t => {
                    const item = document.createElement('p');
                    item.textContent = `ID: ${t.id} | Dil: ${t.languageCode} | T…ôsvir: ${t.description}`;
                    resultDiv.appendChild(item);
                });
            })
            .catch(error => {
                console.error('X…ôta:', error);
                alert('T…ôrc√ºm…ôl…ôri almaq m√ºmk√ºn olmadƒ±');
            });
    });



        document.getElementById('deleteTranslationForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const id = document.getElementById('translateId').value;
        const url = `/api/v1/markers/translate/delete/${id}`;

        fetch(url, {
        method: 'DELETE'
    })
        .then(response => {
        if (!response.ok) {
        return response.text().then(text => { throw new Error(text); });
    }
        return response.json();
    })
        .then(data => {
        alert(`T…ôrc√ºm…ô silindi:\nID: ${data.id}\nDil: ${data.languageCode}`);
    })
        .catch(error => {
        console.error('X…ôta:', error);
        alert('T…ôrc√ºm…ôni silm…ôk m√ºmk√ºn olmadƒ±: ' + error.message);
    });
    });


document.getElementById('updateMarkerTypeForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const markerId = document.getElementById('typeMarkerId').value;
        const markerType = document.getElementById('newMarkerType').value;

        const url = `/api/v1/markers/update-marker-type/${markerId}`;
        const data = new URLSearchParams();
        data.append('markerType', markerType);

        fetch(url, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: data
        })
            .then(response => response.json())
            .then(data => {
                alert(`Status: ${data.status}\nMessage: ${data.message}`);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });
    document.getElementById('updateNameForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const markerId = document.getElementById('markerIdGetN').value;
        const name = document.getElementById('newName').value;

        const url = `/api/v1/markers/update-name/${markerId}`;
        const data = new URLSearchParams();
        data.append('name', name);

        fetch(url, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: data
        })
            .then(response => response.json())
            .then(data => {
                alert(`Status: ${data.status}\nMessage: ${data.message}`);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });
    document.getElementById('updateDescriptionForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const markerId = document.getElementById('markerIdGet').value;
        const description = document.getElementById('newDescription').value;

        const url = `/api/v1/markers/update-description/${markerId}`;
        const data = new URLSearchParams();
        data.append('description', description);

        fetch(url, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: data
        })
            .then(response => response.json())
            .then(data => {
                alert(`Status: ${data.status}\nMessage: ${data.message}`);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });
    document.getElementById('updateForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const markerId = document.getElementById('markerUpId').value;
        const title = document.getElementById('title').value;
        const description = document.getElementById('description').value;
        const markerType = document.getElementById('markerType').value;
        const latitude = document.getElementById('latitude').value;
        const longitude = document.getElementById('longitude').value;

        const url = `/api/v1/markers/update/${markerId}`;
        const data = new URLSearchParams();
        data.append('title', title);
        data.append('description', description);
        data.append('markerType', markerType);
        data.append('latitude', latitude);
        data.append('longitude', longitude);

        fetch(url, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: data
        })
            .then(response => response.json())
            .then(data => {

                alert(`Status: ${data.status}\nMessage: ${data.message}`);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });


    document.getElementById('deleteSingleForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const contactId = document.getElementById('contactId').value;
        const url = `/api/v1/markers/contact/delete/${contactId}`;

        fetch(url, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.json())
            .then(data => {
                alert(`Status: ${data.status}\nMessage: ${data.message}`);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });

    document.getElementById('deleteAllContactsForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const url = '/api/v1/markers/contact/deleteAll';

        fetch(url, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.text())
            .then(data => {
                alert(data);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });



    document.getElementById('deleteAllContactsDuplicates').addEventListener('submit', function (event) {
        event.preventDefault();

        const url = '/api/v1/markers/duplicated/deleteAll';

        fetch(url, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.text())
            .then(data => {
                alert(data);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });

    function showContent(sectionId) {
        const sections = document.querySelectorAll('.content');
        const buttons = document.querySelectorAll('.tab-button');

        sections.forEach(section => {
            section.classList.remove('active');
        });

        buttons.forEach(button => {
            button.classList.remove('active');
        });

        document.getElementById(sectionId).classList.add('active');
        document.querySelector(`button[onclick="showContent('${sectionId}')"]`).classList.add('active');
    }

    document.getElementById('uploadGeoJsonForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const fileInput = document.getElementById('geoJsonFile');
        if (fileInput.files.length === 0) {
            alert("Z…ôhm…ôt olmasa, GeoJSON faylƒ± se√ßin!");
            return;
        }

        const formData = new FormData();
        formData.append('file', fileInput.files[0]);

        fetch('/api/v1/markers/upload-geojson', {
            method: 'POST',
            body: formData
        })
            .then(response => response.text())
            .then(data => {
                alert(data);
            })
            .catch(error => {
                console.error('X…ôta:', error);
                alert("GeoJSON faylƒ±nƒ± y√ºkl…ôm…ôk m√ºmk√ºn olmadƒ±.");
            });
    });

    document.getElementById("addDetailForm").addEventListener("submit", function (event) {
        event.preventDefault();
        const title = document.getElementById("detailName").value;

        fetch("/api/v1/thanks/section?title=" + encodeURIComponent(title), {
            method: "POST"
        }).then(response => response.text())
            .then(alert)
            .then(() => location.reload());
    });

    document.getElementById("addContributorForm").addEventListener("submit", function (event) {
        event.preventDefault();

        const detailSelect = document.getElementById("detailSelect");
        console.log("Dropdown element found:", detailSelect);
        if (detailSelect) {
            console.log("Options count:", detailSelect.options.length);
            console.log("Selected value:", detailSelect.value);
        }
        const sectionId = detailSelect ? detailSelect.value : undefined;
        const contributor = document.getElementById("contributorName").value;

        console.log("Submitting sectionId:", sectionId);  // üîç Check this in the console

        if (!sectionId || isNaN(sectionId)) {
            alert("Z…ôhm…ôt olmasa d√ºzg√ºn b√∂lm…ô se√ßin.");
            return;
        }

        fetch("/api/v1/thanks/contributor", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                sectionId: parseInt(sectionId, 10),  // Ensure it's a number
                contributor: contributor
            })
        }).then(response => {
            if (!response.ok) {
                throw new Error("Contributor could not be added.");
            }
            return response.text();
        }).then(alert)
            .then(() => location.reload())
            .catch(error => {
                console.error("Error:", error);
                alert("X…ôta ba≈ü verdi, z…ôhm…ôt olmasa yenid…ôn c…ôhd edin.");
            });
    });

    document.getElementById("deleteSectionForm").addEventListener("submit", function (event) {
        event.preventDefault();

        const sectionId = document.getElementById("deleteSectionSelect").value;

        fetch(`/api/v1/thanks/section/${sectionId}`, { method: "DELETE" })
            .then(response => response.text())
            .then(alert)
            .then(() => location.reload());
    });

    document.getElementById("deleteContributorForm").addEventListener("submit", function (event) {
        event.preventDefault();

        const sectionId = document.getElementById("deleteContributorSelect").value;
        const contributor = document.getElementById("deleteContributorName").value;

        fetch(`/api/v1/thanks/contributor?sectionId=${sectionId}&contributor=${encodeURIComponent(contributor)}`, {
            method: "DELETE"
        }).then(response => response.text())
            .then(alert)
            .then(() => location.reload());
    });

    fetch("/api/v1/thanks/sections")
        .then(response => response.json())
        .then(sections => {
            console.log("Sections loaded:", sections);  // ‚úÖ This will confirm if sections are fetched

            const selectElements = [
                document.getElementById("detailSelect"),
                document.getElementById("deleteSectionSelect"),
                document.getElementById("deleteContributorSelect")
            ];

            selectElements.forEach(select => {
                if (!select) {
                    console.warn("Dropdown missing for:", select);
                    return;
                }

                select.innerHTML = '<option value="">∆èvv…ôlc…ô bir b√∂lm…ô se√ßin</option>';

                sections.forEach(section => {
                    const option = document.createElement("option");
                    option.value = section.id;   // This must be a number!
                    option.textContent = section.title;
                    select.appendChild(option);
                });
            });
        })
        .catch(error => {
            console.error("Failed to load sections:", error);
        });

    function loadAllContributors() {
        fetch("/api/v1/thanks/contributors")
            .then(response => response.json())
            .then(contributors => {
                const container = document.getElementById("contributorsList");
                if (contributors.length === 0) {
                    container.innerHTML = "<p>He√ß bir i≈ütirak√ßƒ± tapƒ±lmadƒ±.</p>";
                    return;
                }

                container.innerHTML = "";
                contributors.forEach(contributor => {
                    const row = document.createElement("div");
                    row.style.display = "flex";
                    row.style.justifyContent = "space-between";
                    row.style.padding = "5px 0";
                    row.style.borderBottom = "1px solid #ddd";

                    row.innerHTML = `
                    <span>${contributor.sectionTitle} - ${contributor.contributor} (ID: ${contributor.id})</span>
                    <button class="delete-contributor-btn" data-id="${contributor.id}" style="background: #dc3545; color: white; border: none; padding: 5px 10px; cursor: pointer;">Sil</button>
                `;

                    container.appendChild(row);
                });

                document.querySelectorAll(".delete-contributor-btn").forEach(button => {
                    button.addEventListener("click", function () {
                        const id = this.getAttribute("data-id");
                        if (confirm("Bu i≈ütirak√ßƒ±nƒ± silm…ôk ist…ôdiyiniz…ô …ôminsiniz?")) {
                            deleteContributorById(id);
                        }
                    });
                });
            })
            .catch(error => {
                console.error("ƒ∞≈ütirak√ßƒ±larƒ± y√ºkl…ôm…ôk m√ºmk√ºn olmadƒ±:", error);
                document.getElementById("contributorsList").innerHTML = "<p>X…ôta ba≈ü verdi, yenid…ôn yoxlayƒ±n.</p>";
            });
    }

    function deleteContributorById(entryId) {
        fetch(`/api/v1/thanks/contributor/${entryId}`, {
            method: "DELETE"
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Silinm…ô zamanƒ± x…ôta ba≈ü verdi");
                }
                return response.text();
            })
            .then(message => {
                alert(message);
                loadAllContributors(); // Refresh after delete
            })
            .catch(error => {
                console.error("Error silm…ô zamanƒ±:", error);
                alert("X…ôta ba≈ü verdi.");
            });
    }

    document.getElementById("deleteContributorByIdForm").addEventListener("submit", function (event) {
        event.preventDefault();

        const entryId = document.getElementById("deleteContributorById").value;
        if (confirm(`ID-si ${entryId} olan i≈ütirak√ßƒ±nƒ± silm…ôk ist…ôdiyiniz…ô …ôminsiniz?`)) {
            deleteContributorById(entryId);
        }
    });

    document.addEventListener("DOMContentLoaded", function () {
        loadAllContributors(); // Load contributors when page loads
    });

</script>
</body>
</html>


